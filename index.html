<!doctype html>
<html>
  <head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="chrome=1">
    <title>Snz-server</title>
    <link rel="stylesheet" href="stylesheets/styles.css">
    <link rel="stylesheet" href="stylesheets/github-dark.css">
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/1.7.1/jquery.min.js"></script>
    <script src="javascripts/respond.js"></script>
    <!--[if lt IE 9]>
      <script src="//html5shiv.googlecode.com/svn/trunk/html5.js"></script>
    <![endif]-->
    <!--[if lt IE 8]>
    <link rel="stylesheet" href="stylesheets/ie.css">
    <![endif]-->
    <meta name="viewport" content="width=device-width, initial-scale=1, user-scalable=no">

  </head>
  <body>
      <div id="header">
        <nav>
          <li class="fork"><a href="https://github.com/hyptos/snz-server">Server On GitHub</a></li>
          <li class="fork"><a href="https://github.com/hyptos/snz-client">Client On GitHub</a></li>
          <li class="downloads"><a href="https://github.com/hyptos/snz-client/zipball/master">ZIP client</a></li>
          <li class="downloads"><a href="https://github.com/hyptos/snz-server/zipball/master">ZIP server</a></li>
          <li class="title">DOWNLOADS</li>
        </nav>
      </div><!-- end header -->

    <div class="wrapper">

      <section>
        <div id="title">
          <h1>Projet SnZ</h1>
          <p></p>
  		  <hr> 
  		  <img src="images/header.jpg">
          <hr>
          
          </span>
          <span class="credits right">Hosted on GitHub Pages &mdash; Theme by <a href="https://twitter.com/michigangraham">mattgraham</a></span>
        </div>


<h3>
<a id="designer-templates" class="anchor" href="#introduction" aria-hidden="true"><span class="octicon octicon-link"></span></a>Introduction</h3>

<div style="text-align: justify">
  
<p>Le but de ce projet est de réaliser une application client/serveur dans un contexte MMO. Notre jeu est un jeu de survie à la première personne (FPS). Dans un monde post-apocalyptique, le joueur doit survivre dans un monde peuplé de zombie.</p>

<p>Ce projet se divise en deux parties, un serveur et un client. Chaque client peut se connecter au serveur. Le client est implémenté en C# avec Unity tandis que le serveur a été implémenter en C++. La connexion entre le client et le serveur se fait uniquement en TCP.</p>

<p>Ce projet a été réalisé par :
<ul> 
<li>Antoine Martin aka <a href="https://github.com/hyptos">hyptos</a> (Connexion Client/Serveur)</li>
<li>Antoine Richard aka <a href="https://github.com/Avzgui">Avzgui</a> (IA)</li>
<li>Clément Picq aka <a href="https://github.com/IroneP">IroneP</a> (Connexion Client/Serveur)</li>
<li>Adrien Faure aka <a href="https://github.com/oldDadou">oldDadou</a> (Serveur)</li>
<li>Cristophe Pinelli aka <a href="https://github.com/Kappasaleth">Kappasaleth</a> (IHM)</li>
<li>Raphael Fiume aka <a href="https://github.com/McCowboy">McCowboy</a> (Unity)</li>
<li>Cynthia Perret (IHM)</li>
<li>Lucas Bercheti aka <a href="https://github.com/Dragzal">Dragzal</a> (Unity)</li>
</ul>
</p>

<p>Vous pouvez accéder au repository de la partie serveur en suivant ce lient : <a id="lien-serveur" href="https://github.com/hyptos/snz-server" aria-hidden="true">snz-server</a></p>

<p>Vous pouvez accéder au repository de la partie client en suivant ce lient : <a id="lien-client" href="https://github.com/hyptos/snz-client" aria-hidden="true">snz-client</a></p>




<h3>
<a id="designer-templates" class="anchor" href="#intro-server" aria-hidden="true"><span class="octicon octicon-link"></span></a>Partie Serveur</h3>
<h3>Présentation</h3>
<p>
   Le serveur de communication est implémenté directement dessus le serveur de socket fournis avec le projet. Il présente
une interface de passage de messages et permet la connexion simultané de plusieurs clients. Même si destiné au
jeux, celui ci est tout à fait générique.
</p>
<h4>Les messages</h4>
<p>
Chaque données devant être envoyé/reçu par le serveur devra implémenter un classe virtuel pure de message generique (IMessage).
L'interface IMessage demande l'implémentation des fonctions permettant l'encodage de la donné en flux d'octets, ainsi que de spécifié le tag du message. Ceci servira à l'identification du type de message,  et est necessaire pour l'indentification des flux d'octets.
</p>
<h4>Les interfaces du serveur</h4>
<p>
Ensuite, le serveur de communication présente deux intefaces, la première permmettra l'envoie de message. En identifiant un  client grâce à un id, le serveur sera capable d'envoyé le message. La seconde intereface pêrmet la reception de message. Chaques module présent sur le serveur desireux de recevoir un type de message devra alors implémenter une interface ("MessageHandler"). Il suffira ensuite s'abonner au serveur en notifiant le type des messages souhaité. Il est à noté qu'il est de la responsabilité du message handler de décoder le message, car le server transmettra uniquement un flux d'octet ainsi que le type de message transmis (ce qui permet de s'abonner à plusieur type de messages).
</p>

<h3>
<a id="designer-templates" class="anchor" href="#intro-client" aria-hidden="true"><span class="octicon octicon-link"></span></a>Partie Client</h3>

<p>Le principal rôle de la partie client est de faire le lien entre ce que nous envoie le serveur et ce dont unity a besoin pour fonctionner. Pour cela, nous avons créer plusieurs fonctions qui 
récupèrent une chaine d'octect, et selon l'ID qui a été envoyer en tête de la chaîne, récupère le message voulu. Ainsi, en imposant un formalisme précis entre le client et le serveur, on peut faire
transiter des messages de type Mesh, String, Event (type que nous avons créé pour signaler un mouvement) et connexion.</p>
<p>
  De plus, il est de la responsabilité du client d'informer en temps réelle la position du joueur au serveur. Le serveur, lui, va envoyer continuellement la position de chacun des zombies
pour que le client puisse mettre à jour son affichage. Tout les mouvement des zombies sont calculés par le serveur.
</p>

<p>
Nous avons deux protagonistes : 
<ul>
<li>Zombie ( contrôleur a la troisième personne avec animation ) réception des données 
<li>Joueur ( contrôleur a la première personne sans animation) envoi de données </li>
<li>Joueur ( vue a la troisième personne afin d'intensifier l’immersion) déplacement (zqsd) avec mouvement de la tête par la souris</li> 
<li>Passage du menu au jeu par un système de chargement afin que la map soit chargée avant l'entrée en jeu</li>
<li> Bande-son ajoutée </li>
</ul>
</p>


<h3>
<a id="designer-templates" class="anchor" href="#intro-ia" aria-hidden="true"><span class="octicon octicon-link"></span></a>Partie Intelligence Artificielle</h3>

<p>
Le but de notre projet était de créer un Système Multi-Agents (SMA) représentant un écosystème 
post-apocalyptique. Nous avons donc voulu que des zombies parcourent l'environnement, se déplaçant
et réagissant de manière "vraisemblable" et indépendante du joueur, c'est à dire qu'ils ne soient pas
simplement des bots ayant une zone de déplacement et réaparaissant après un certain temps.
</p>

<p>
Nous voulions que nos zombies se déplacent en "horde" à travers l'environnement, qu'ils réagissent
au sons, à la lumière et à la vue d'un ou plusieurs joueurs.
</p>
  
<img src="images/horde.jpg"><br/>

<p>
Afin d'implémenter ce SMA nous avons utilisé une implémentation permettant de lancer les agents à
l'aide de threads en suivant le schéma suivant :
<ul>
<li>Le modèle créer un Environnement et des Entités, 
entités qu'il lie à l'envrionnement lors de leur création.</li>
<li>Chaque entité possèdent un Corps dans l'environnement.</li>
<li>Un Agent est une entité, mais un entité peut etre un objet, un joueur ou un agent.</li>
<li>Le corps de chaque agent possède un certain nombre de modules "senseurs" captant les 
divers stimuli envoyé depuis l'environnement.</li>
<li>Le corps de chaque agent possède un certain nombre de modules "moteurs" lui permettant
d'effectuer des actions sur l'environnement.</li>
<li>Les Stimuli peuvent etre sonore ou visuel et sont générés depuis l'environnement.</li>
<li>Chaque modules est lancé dans un thread.</li>
</ul>
</p>


<div style="text-align: center">
  <img src="images/SNZ_Class_Diagram.png">
</div>

<p>
Pour donner aux zombies le comportement que nous souhaitions, c'est à dire :
<ul>
  <li>Se déplacer en groupe.</li>
  <li>Etre attiré par le bruit.</li>
  <li>Attaquer les joueurs.</li>
</ul>

<div style="text-align: center">
  <img src="images/flocking.png">
</div>

Nous avons implémenté un algorithme de flocking, afin qu'ils se regroupent et 
se suivent de manière plus ou moins "organisé", en y ajoutant de légères modifications
pour qu'ils soient attiré par les joueurs (au bruit ou à la vue) et qu'ils soient légèrement
moins "organisés" lorsqu'ils se dirigent sur un joueur étant entré dans leur champ de vision.

</p>

<p>
Ainsi nous obtenons le comportement souhaité : des hordes de zombies parcourant l'environnement
et pouvant tomber à tout moment sur le joueur.
</p>

<div style="text-align: center">
  <img src="images/Walking_Dead.jpg">
</div>


<h3>
<a id="designer-templates" class="anchor" href="#marche" aria-hidden="true"><span class="octicon octicon-link"></span></a>Ce qui fonctionne</h3>

<p>Voici les fonctionnalités implémentées : </p>
<ul>
  <li>Connexion client/serveur</li>
  <li>Envoies de mesh au client</li>
  <li>Envoies/Reception de données au client</li>
  <li>Envoies/Reception de données au serveur</li>
  <li>Système multi-agent côté serveur</li>
</ul>


<h3>
<a id="designer-templates" class="anchor" href="#amelioration" aria-hidden="true"><span class="octicon octicon-link"></span></a>Les améliorations possibles</h3>


<p>
<ul>
<li>Ajouter les zombies dans le client de manière dynamique.</li>
<li>Mettre en place un système de "chunk" envoyé depuis le serveur.</li>
<li>Refonte du Moteur IA afin de pouvoir lancer les agents dans des processus plutot que
dans des threads et utiliser des temps logiques plutot que des temps réels.</li>
<li>Ajout de divers autres agents :
<ul><li>Des chiens, pouvant s'attacher ou non aux joueurs, les aider, trouver des objets.
Pouvant se déplacer en meute, communiquant par "aboiements".</li>
<li>Divers animaux pouvant etre "élevé" par les joueurs : vache, poulet, cochon ...
Mais pouvant aussi etre attaqué par les zombies.</li>
<li>Des arbres, plantes et céréales, pouvant etre cultivés par les joueurs et réagissant
au soleil et à l'eau pour croitre.</li>
</ul>
</li>
<li>Créer des intéractions entre joueurs, agents et environnement.</li>
<li>Créer un système de craft.</li>
</ul>
</p>

</div>

<h3>
<a id="designer-templates" class="anchor" href="#screenshots" aria-hidden="true"><span class="octicon octicon-link"></span></a>Screenshots</h3>
      </section>

    </div>
    <!--[if !IE]><script>fixScale(document);</script><![endif]-->
  </body>
</html>
